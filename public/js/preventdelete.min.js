(function(){Array.prototype.contains=function(b){return this.indexOf(b)>-1};function a(){var b=this;function e(h,g,f){return h>=g&&h<=f}function d(h,j,g){g=g===false?false:true;for(var f=g?j-1:j;g?f>0:f<h.length;g?f--:f++){if([160,32].contains(h.charCodeAt(f))){continue}else{return true}}return false}function c(l,m,h){var k=false;var g=false;h=h===false?false:true;for(var f=h?m-1:m;h?f>0:f<l.length;h?f--:f++){var j=[160,32].contains(l.charCodeAt(f));if(!g&&j){g=true}else{if(!k&&!j){k=true}}if(g&&k){return true}}return false}this.root_id="tinymce";this.preventdelete_class="mceNonEditable";this.nextElement=function(g){var f=$(g);var h=f.next();while(h.length==0){f=f.parent();if(f.attr("id")==b.root_id){return false}h=f.next()}return h};this.prevElement=function(g){var f=$(g);var h=f.prev();while(h.length==0){f=f.parent();if(f.attr("id")==b.root_id){return false}h=f.prev()}return h};this.keyWillDelete=function(f){var g=f.keyCode;if(f.ctrlKey){return f.key=="x"||[8,46].contains(g)}return[8,9,13,46].contains(g)||e(g,48,57)||e(g,65,90)||e(g,96,111)||e(g,186,192)||e(g,219,222)};this.cancelKey=function(f){f.preventDefault();f.stopPropagation();return false};this.check=function(f){return $(f).hasClass(b.preventdelete_class)};this.checkParents=function(f){if(!f){return true}return $(f).parents("."+b.preventdelete_class).length>0};this.checkChildren=function(f){if(!f){return false}return $(f).find("."+b.preventdelete_class).length>0};this.logElem=function(g){var h={};var f=["innerHTML","nodeName","nodeType","nextSibling","previousSibling","outerHTML","parentElement","data"];f.forEach(function(i){h[i]=g[i]})};tinymce.PluginManager.add("preventdelete",function(f,g){f.on("keydown",function(v){if(!b.keyWillDelete(v)){return true}var m=tinymce.activeEditor.selection.getNode();if(b.check(m)||b.checkChildren(m)){return b.cancelKey(v)}var q=tinymce.activeEditor.selection.getRng();b.logElem(q.startContainer);var o=v.keyCode==8;var w=v.keyCode==46;var h;for(var s=q.startContainer;!h&&s;s=s.nextSibling){h=h||b.check(s);if(q.endContainer===s){break}}var l=q.endContainer;if(l&&q.endOffset===0&&(b.check(l)||b.checkChildren(l))){return b.cancelKey(v)}if(h){return b.cancelKey(v)}var r=(q.endContainer.data||"");var u=q.startContainer.data&&q.startContainer.data.charCodeAt(0)===65279;var i=w&&q.endContainer.data&&(q.endOffset<r.length)&&!(u&&r.length===1);var t=o&&q.startContainer.data&&q.startOffset>u;var n=q.startOffset===q.endOffset;var x=(v.ctrlKey&&(o||w))&&!c(q.startContainer.data,q.startOffset,o);if(i||t){if(!x){return true}}if(!x){if(w&&n&&(q.startOffset+1)<q.endContainer.childElementCount){var j=q.endContainer.childNodes[q.startOffset+1];return b.check(j)?b.cancelKey(v):true}if(q.startOffset!==q.endOffset){return h?b.cancelKey(v):true}}if(w){var p=b.nextElement(q.endContainer);if(!p){return b.cancelKey(v)}if(b.check(p)||b.checkChildren(p)){return b.cancelKey(v)}}if(o){var k=b.prevElement(q.startContainer);if(b.check(k)){return b.cancelKey(v)}}})})}new a()})();